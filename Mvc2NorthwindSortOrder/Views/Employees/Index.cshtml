<h1>Employees</h1>
<div id="jsGrid"></div>

<link href="~/css/jsgrid-theme.css" rel="stylesheet" />
<link href="~/css/jsgrid.css" rel="stylesheet" />
<script src="~/js/jsgrid.js"></script>
<script src="~/js/jsGridExtra.js"></script>

<script type="text/javascript">

    $("#jsGrid").jsGrid({
        width: "100%",
        height: "500px",
        autoload: false,
        inserting: false,
        editing: false,
        sorting: true,
        paging: true,
        pageLoading: true,
        filtering: true,
        rowDoubleClick: function (args) { window.location.href = "/Employees/Edit?id=" + args.item.id; },
        pageSize: 5,
        pageButtonCount: 5,

        controller: {
            loadData: function (filter) {
                return $.ajax({
                    type: "GET",
                    url: "/Employees/GetRows",
                    data: filter
                });
            }
        },

        fields: [
            { name: "id", type: "text", width: 150, visible: false },
            { name: "lastName", type: "text", width: 190, validate: "required", filterTemplate: createTextFilterTemplate("lastName") },
            { name: "firstName", type: "text", width: 190, validate: "required", filterTemplate: createTextFilterTemplate("firstName") },
            { name: "title", title: "Titel", type: "text", width: 200, filterTemplate: createTextFilterTemplate("title") },
            { name: "city", title: "Stad", type: "text", width: 200, filterTemplate: createTextFilterTemplate("city") },
            { name: "homephone", title: "Tel", type: "text", width: 200, filterTemplate: createTextFilterTemplate("homephone") }
        ]
    });

    var grid = $("#jsGrid").data("JSGrid");
    grid.sort();

    function createTextFilterTemplate(propertyName) {
        return function () {
            if (!this.filtering)
                return "";
            var existing = JSON.parse(localStorage.getItem(window.location.href));

            var grid = this._grid,
                $result = this.filterControl = this._createTextBox();
            if (this.autosearch) {
                $result.on("keypress",
                    function (e) {
                        if (e.which === 13) {
                            grid.search();
                            e.preventDefault();
                        }
                    });
            }
            var gridFilter = existing;
            if (gridFilter && gridFilter[propertyName]) {
                $result.val(gridFilter[propertyName]);
            }

            return $result;
        }
    }
</script>






